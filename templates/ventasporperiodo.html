{% extends "layout.html" %}

{% block title %}Ventas por Período{% endblock %}

{% block content %}
<h2>Ventas por Período</h2>

<form method="POST" class="mb-4">
  <div class="form-group">
    <label>Fecha inicio:</label>
    <input type="date" name="fecha_inicio" class="form-control" required>
  </div>
  <div class="form-group">
    <label>Fecha fin:</label>
    <input type="date" name="fecha_fin" class="form-control" required>
  </div>
  <button type="submit" class="btn btn-primary mt-2">Consultar</button>
</form>

{% if facturas %}
  <h4>Resultados:</h4>
  <table class="table table-bordered">
    <thead>
      <tr>
        <th>ID</th>
        <th>Cliente</th>
        <th>Fecha</th>
        <th>Total</th>
      </tr>
    </thead>
    <tbody>
      {% for factura in facturas %}
      <tr>
        <td>{{ factura.id }}</td>
        <td>{{ factura.cliente.nombre }}</td>
        <td>{{ factura.fecha.strftime('%d/%m/%Y') }}</td>
        <td>${{ factura.total }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <h5 class="mt-3">Total vendido en el período: ${{ total_periodo }}</h5>

{% elif fecha_inicio and fecha_fin %}
  <p>No hay facturas en ese rango de fechas.</p>
{% endif %}
{% endblock %}
